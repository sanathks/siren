# Siren - LLM Integration Guide

Siren is a visual diagram editor. AI agents can create diagrams programmatically.

## Color Palette (Tokyo Night Storm)

Use these colors for consistent styling:

| Color     | Hex       | Use Case                     |
|-----------|-----------|------------------------------|
| Background| `#24283b` | Canvas background            |
| Foreground| `#c0caf5` | Text, labels                 |
| Blue      | `#7aa2f7` | Primary nodes, default fill  |
| Cyan      | `#7dcfff` | Secondary nodes, highlights  |
| Green     | `#9ece6a` | Success, start nodes         |
| Red       | `#f7768e` | Error, end nodes             |
| Yellow    | `#e0af68` | Warning, decision nodes      |
| Magenta   | `#bb9af7` | Accent, special nodes        |
| Orange    | `#ff9e64` | Attention, action nodes      |
| Border    | `#414868` | Node outlines, lines         |

## Quick Start

Generate a shareable diagram URL by calling the API:

```bash
curl -X POST https://siren.sanath.dev/api/diagram \
  -H "Content-Type: application/json" \
  -d '{"mermaid": "flowchart TD\n  A[Start] --> B{Decision}\n  B -->|Yes| C[Action]\n  B -->|No| D[End]"}'
```

Response:
```json
{
  "url": "https://siren.sanath.dev/#eyJuIjpb...",
  "data": { "n": [...], "c": [...] }
}
```

## API Endpoints

### 1. Generate Shareable URL

**POST https://siren.sanath.dev/api/diagram**

Returns an interactive URL that users can open and edit.

### 2. Export as PNG Image

**POST https://siren.sanath.dev/api/diagram/image**

Returns a PNG image file directly. Use this when you need to embed or download a diagram image.

```bash
curl -X POST https://siren.sanath.dev/api/diagram/image \
  -H "Content-Type: application/json" \
  -d '{"mermaid": "flowchart TD\n  A[Start] --> B[End]"}' \
  --output diagram.png
```

Optional parameters:
- `width`: Viewport width (default: 1200)
- `height`: Viewport height (default: 800)
- `scale`: Device scale factor for higher resolution (default: 2)

---

**POST https://siren.sanath.dev/api/diagram**

### Option 1: Send Mermaid Code

```json
{
  "mermaid": "flowchart TD\n  A[Start] --> B[End]"
}
```

### Option 2: Send JSON Directly

```json
{
  "nodes": [
    {
      "id": "n1",
      "type": "rect",
      "label": "Start",
      "x": 100,
      "y": 100,
      "width": 120,
      "height": 44
    },
    {
      "id": "n2",
      "type": "diamond",
      "label": "Decision?",
      "x": 100,
      "y": 200,
      "width": 100,
      "height": 60
    }
  ],
  "connections": [
    {
      "id": "c1",
      "from": "n1",
      "to": "n2",
      "label": "next"
    }
  ]
}
```

## JSON Schema

### Node Types

| Type | Description | Default Size |
|------|-------------|--------------|
| `rect` | Rectangle | 120x44 |
| `pill` | Rounded rectangle | 120x44 |
| `diamond` | Decision diamond | 100x60 |
| `circle` | Circle | 60x60 |
| `container` | Grouping box | 200x150 |
| `text` | Text label | auto |

### Node Properties

```json
{
  "id": "n1",           // Unique identifier
  "type": "rect",       // Shape type
  "label": "My Node",   // Display text
  "x": 100,             // X position
  "y": 100,             // Y position
  "width": 120,         // Width in pixels
  "height": 44,         // Height in pixels
  "color": "#7aa2f7",   // Optional: fill color (Tokyo Night blue)
  "outlineColor": "#414868" // Optional: border color
}
```

### Recommended Node Colors by Type

- **Start nodes:** `#9ece6a` (green)
- **End nodes:** `#f7768e` (red)
- **Decision nodes:** `#e0af68` (yellow)
- **Process nodes:** `#7aa2f7` (blue)
- **Action nodes:** `#ff9e64` (orange)
- **Special nodes:** `#bb9af7` (magenta)
- **Info nodes:** `#7dcfff` (cyan)
```

### Connection Properties

```json
{
  "id": "c1",           // Unique identifier
  "from": "n1",         // Source node ID
  "to": "n2",           // Target node ID
  "label": "yes",       // Optional: label text
  "lineStyle": "solid", // Optional: "solid" or "dashed"
  "color": "#7aa2f7"    // Optional: line color
}
```

### Sequence Diagram Nodes

For sequence diagrams, add these properties:

```json
{
  "id": "n1",
  "type": "rect",
  "label": "Alice",
  "isParticipant": true,
  "hasLifeline": true
}
```

Sequence connections:
```json
{
  "id": "c1",
  "from": "n1",
  "to": "n2",
  "isSequenceMessage": true,
  "messageY": 180,
  "arrow": "->>"
}
```

## Generate URL Without API

You can create URLs client-side:

```javascript
const diagram = {
  n: [
    { id: "n1", type: "rect", label: "Hello", x: 100, y: 100, width: 120, height: 44 }
  ],
  c: []
};

const url = "https://siren.sanath.dev/#" + btoa(encodeURIComponent(JSON.stringify(diagram)));
// User can open this URL to see and edit the diagram
```

## Mermaid Syntax Support

The API supports standard Mermaid flowchart syntax:

```
flowchart TD
  A[Rectangle] --> B(Pill)
  B --> C{Diamond}
  C -->|Yes| D((Circle))
  C -->|No| E[End]
```

Arrow types:
- `-->` Solid arrow
- `---` Solid line (no arrow)
- `-.->` Dashed arrow
- `==>` Thick arrow

## Example Prompts for AI

When users ask you to create diagrams, generate Mermaid code and call the API:

**User:** "Create a flowchart for user login"

**AI Response:**
```
I'll create that diagram for you.

[Call API with:]
{
  "mermaid": "flowchart TD\n  A[User visits site] --> B{Logged in?}\n  B -->|Yes| C[Show dashboard]\n  B -->|No| D[Show login form]\n  D --> E[Enter credentials]\n  E --> F{Valid?}\n  F -->|Yes| C\n  F -->|No| G[Show error]\n  G --> D"
}

Here's your diagram: [returned URL]
```

## MCP Server

For Claude Desktop integration, Siren also provides an MCP server.
See: https://github.com/sanathks/siren/tree/main/mcp
